# VM Navigation
function www() { cd /var/www/magento }

# CLI
own() { www && sudo chown -R vagrant:vagrant var/cache/ var/page_cache/ && sudo chmod -R 777 var/ pub/ app/etc/ generated/ }
cache() { www && ./bin/magento cache:clean }
flush-cache() { www && ./bin/magento cache:flush }
enable-cache() { www && ./bin/magento cache:enable }
disable-cache() { www && ./bin/magento cache:disable }
disable-cms-cache() { www && ./bin/magento cache:disable layout block_html full_page }
reindex() { www && ./bin/magento indexer:reindex }
clean() { reindex && cache }
cron() { www && ./bin/magento cron:run }
staging() { reindex && cron && cron && cache }
list-modules() { www && ./bin/magento module:status }
enable-all-modules() { www && ./bin/magento module:enable --all }
db-upgrade() { www && ./bin/magento setup:upgrade }
di-compile() { www && ./bin/magento setup:di:compile }
deploy-content() { www && ./bin/magento setup:static-content:deploy -f }
deploy-content-de() { www && ./bin/magento setup:static-content:deploy de_DE -f }
dev-mode() { www && ./bin/magento deploy:mode:set developer && cache }
prod-mode() { www && ./bin/magento deploy:mode:set production && cache }

# Extensions and Upgrades
add-key() { eval $(ssh-agent) && ssh-add ~/.ssh/Magento-Cloud }
update-composer() { www && add-key && composer update }
add-modules() { www && db-upgrade && di-compile && deploy-content && deploy-content-de && cache }
refresh-theme() { www && rm -rf var/view_preprocessed && deploy-content && cache }
upgrade() { www && update-composer && db-upgrade && di-compile && deploy-content && deploy-content-de && cache }

# Web
start-web() { sudo systemctl restart nginx }
stop-web() { sudo systemctl stop nginx }
status-web() { sudo systemctl status nginx }

# Database
db() { mysql -u magento -ppassword }
start-db() { systemctl restart mysql }
stop-db() { sudo systemctl stop mysql }
status-db() { sudo systemctl status mysql }

# Tools
warm-cache() { www && sh cache-warmer.sh }
kill-php() { sudo pkill -9 php }
update-cli() { add-key && cd ~/cli/ && git pull && source ~/.bashrc && www }
vm-help() { clear && cat ~/cli/help.txt }
